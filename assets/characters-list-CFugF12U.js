import{u as L,a as _,j as e,B as F,i as E,b as k,r as d}from"./index-Ch0UEPDC.js";import{u as H}from"./action-B22Wi-OJ.js";const R=c=>{const s="card",{id:a,name:i,image:o}=c,n=L(),{favorites:t,addFavorite:h,removeFavorite:m}=_(),{isFavorite:v,icon:g}=t.includes(a)?{isFavorite:!0,icon:{iconImg:E,iconName:"iconheart"}}:{isFavorite:!1,icon:{iconImg:k,iconName:"iconheartempty"}},l=()=>{a&&(v?m(a):h(a))};return e.jsxs("div",{className:`${s}__wrapper`,children:[e.jsx("div",{className:`${s}__img-wrapper`,onClick:p=>{p.stopPropagation(),n(`/detail/${a}`)},children:e.jsx("img",{className:`${s}__img`,src:o})}),e.jsxs("div",{className:`${s}__info-wrapper`,children:[e.jsx("div",{className:`${s}__divider`}),e.jsx("span",{className:`${s}__info-name`,children:i}),e.jsx("div",{className:`${s}__icon-fav`,children:e.jsx(F,{characterFav:a,size:"small",icon:g,onClick:l})})]})]})},S="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2%202.76927L9.23073%2010L2%2017.2307L2.76927%2018L10%2010.7693L17.2307%2018L18%2017.2307L10.7693%2010L18%202.76927L17.2307%202L10%209.23073L2.76927%202L2%202.76927Z'%20fill='black'/%3e%3c/svg%3e",A="data:image/svg+xml,%3csvg%20width='13'%20height='13'%20viewBox='0%200%2013%2013'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M11.9062%2010.9893C12.0234%2011.1064%2012.0234%2011.2939%2011.9062%2011.3877L11.3672%2011.9268C11.2734%2012.0439%2011.0859%2012.0439%2010.9688%2011.9268L8.13281%209.09082C8.08594%209.02051%208.0625%208.9502%208.0625%208.87988V8.5752C7.19531%209.30176%206.09375%209.74707%204.875%209.74707C2.17969%209.74707%200%207.56738%200%204.87207C0%202.2002%202.17969%20-0.00292969%204.875%20-0.00292969C7.54688%20-0.00292969%209.75%202.2002%209.75%204.87207C9.75%206.09082%209.28125%207.21582%208.55469%208.05957H8.85938C8.92969%208.05957%209%208.10645%209.07031%208.15332L11.9062%2010.9893ZM4.875%208.62207C6.9375%208.62207%208.625%206.95801%208.625%204.87207C8.625%202.80957%206.9375%201.12207%204.875%201.12207C2.78906%201.12207%201.125%202.80957%201.125%204.87207C1.125%206.95801%202.78906%208.62207%204.875%208.62207Z'%20fill='black'/%3e%3c/svg%3e",b=c=>{const s="search",{onSearch:a}=c,i=d.useRef(null),o=t=>{a&&a(t.target.value)},n=()=>{i.current&&(i.current.value="",a&&a(""))};return d.useEffect(()=>{i.current?.focus()},[]),e.jsx("div",{className:s,children:e.jsxs("div",{className:`${s}__input-wrapper`,children:[e.jsx("div",{className:`${s}__icon-wrapper`,children:e.jsx("img",{className:`${s}__icon`,src:A})}),e.jsx("input",{ref:i,id:"search-input",type:"text",placeholder:"SEARCH A CHARACTER...",className:`${s}-input`,onChange:o,onFocus:t=>t.target.placeholder="",onBlur:t=>t.target.placeholder="SEARCH A CHARACTER...","data-testid":"search-input"}),e.jsx("div",{className:`${s}__clear-icon-wrapper`,onClick:n,children:e.jsx("img",{className:`${s}__clear-icon`,src:S})})]})})},I=()=>{const c="characters-list",[s,a]=d.useState(""),{data:i,fetchNextPage:o,hasNextPage:n,isFetchingNextPage:t,isLoading:h,isError:m,totalCharacters:v,allCharacters:g}=H(s),{showFavorites:l,favorites:p}=_(),C=r=>{const{scrollTop:j,scrollHeight:$,clientHeight:w}=r.currentTarget;$-j===w&&n&&o()},N=d.useCallback(r=>{(r.length>=3||r.length===0)&&a(r)},[]),u=g?.filter(r=>p.includes(r.id)),f=l?u:i,x=l?u?.length:v;return e.jsxs("div",{className:`${c}__wrapper`,onScroll:C,children:[l&&e.jsx("div",{className:`${c}__title-favorites`,children:"Favorites"}),e.jsxs("div",{className:`${c}__search-wrapper`,children:[e.jsx(b,{onSearch:N}),e.jsxs("div",{className:`${c}-results`,children:[" ",x?`${x} results`:"No results"," "]})]}),e.jsxs("div",{className:`${c}__cards-list`,children:[f?.map(r=>d.createElement(R,{...r,key:r.id})),t&&e.jsx("div",{className:`${c}__loading`,children:"Loading more..."}),m&&e.jsx("div",{className:`${c}__error`,children:"Error loading characters"})]}),!n&&!h&&!l&&e.jsx("div",{className:`${c}__end`,children:"No more characters"})]})};export{I as default};
